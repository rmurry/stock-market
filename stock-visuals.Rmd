---
title: "US Economic Data"
output:
  flexdashboard::flex_dashboard:
    vertical_layout: fill
---

```{r setup, include=FALSE}
setwd('D:/GitHub/stock-market')
knitr::opts_chunk$set(echo = TRUE, 
                      message = FALSE, 
                      warning = FALSE, 
                      fig.align = "center",
                      dpi = 144)
remove(list = ls(all.names = TRUE))
detachAllPackages <- function() {
  basic.packages.blank <-  c("stats","graphics","grDevices","utils","datasets","methods","base")
  basic.packages <- paste("package:", basic.packages.blank, sep = "")
  package.list <- search()[ifelse(unlist(gregexpr("package:", search())) == 1,TRUE,FALSE)]
  package.list <- setdiff(package.list, basic.packages)
  if (length(package.list) > 0)  for (package in package.list) {
    detach(package, character.only = TRUE)}}
detachAllPackages()
if (!require(pacman)) {
  install.packages("pacman")
  require(pacman)
}

p_load(readxl,tidyverse,highcharter,readr,timetk,quantmod)
```

```{r,  Data Load}
### Just pulled S&P500 Historic Data from Yahoo for convenience
sp500 <- read_csv('sp500.csv') %>%
  mutate(Date = as.Date(Date,format = '%Y-%-%d'))

testSP <- sp500 %>% filter(Date > as.Date('2009-01-01','%Y-%m-%d'))
test <- lm(Close ~ Date,testSP)
r2 <- summary(test)
r2 <- round(as.numeric(r2$r.squared)*100,2)
testSP$fitted <- test$fitted.values

testSP <- xts(testSP[-1],order.by = testSP$Date)


```

# Stock Market Data and Trends

```{r}
highchart(type = "stock") %>%
  hc_add_series(testSP$Close,type = 'line') %>%
  hc_add_series(testSP$fitted,type = 'line') %>%
  hc_title(text = paste('Linear Regression on S&P 500 - Accuracy of just time:',r2))
#hchart(sp500,'line',hcaes(x = Date,y = Close))
```
