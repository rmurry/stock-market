---
title: "US Economic Data"
output:
  flexdashboard::flex_dashboard:
    vertical_layout: fill
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      message = FALSE, 
                      warning = FALSE, 
                      fig.align = "center",
                      dpi = 144)
remove(list = ls(all.names = TRUE))
detachAllPackages <- function() {
  basic.packages.blank <-  c("stats","graphics","grDevices","utils","datasets","methods","base")
  basic.packages <- paste("package:", basic.packages.blank, sep = "")
  package.list <- search()[ifelse(unlist(gregexpr("package:", search())) == 1,TRUE,FALSE)]
  package.list <- setdiff(package.list, basic.packages)
  if (length(package.list) > 0)  for (package in package.list) {
    detach(package, character.only = TRUE)}}
detachAllPackages()
if (!require(pacman)) {
  install.packages("pacman")
  require(pacman)
}

p_load(flexdashboard,readxl,tidyverse,highcharter,readr,timetk,quantmod)
```

```{r,  Data Load}
SP500 <- getSymbols("^GSPC",auto.assign = F,from = "2009-01-20")
SP500 <- data.frame(SP500,Date = index(SP500))
lmSP <- lm(GSPC.Close ~ Date,SP500)
results <- summary(lmSP)
SP500$fitted <- lmSP$fitted.values
```

# Stock Market Data and Trends

```{r}
highchart(type = "stock") %>%
  hc_add_series(SP500$GSPC.Close,type = 'line') %>%
  hc_add_series(SP500$fitted,type = 'line') %>%
  hc_title(text = paste('Linear Regression on S&P 500 - Accuracy of just time:',round(as.numeric(results$r.squared)*100,2)))
```
